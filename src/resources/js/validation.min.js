tribe.validation={},function(a,t,i){"use strict";var e=t(document);a.selectors={item:".tribe-validation",fields:"input, select, textarea",submit:'input[type="submit"], button',error:".tribe-validation-error",valid:".tribe-validation-valid",notice:".tribe-notice-validation",noticeAfter:".wp-header-end",noticeDismiss:".notice-dismiss"},a.conditions={isRequired:function(a){return""!=a},isGreaterThan:function(t,i,e){var r=a.parseConditon("isGreaterThan",t,i,e);return r.constraint<r.value},isGreaterOrEqualTo:function(t,i,e){var r=a.parseConditon("isGreaterOrEqualTo",t,i,e);return r.constraint<=r.value},isLessThan:function(t,i,e){var r=a.parseConditon("isLessThan",t,i,e);return r.constraint>r.value},isLessOrEqualTo:function(t,i,e){var r=a.parseConditon("isLessOrEqualTo",t,i,e);return r.constraint>=r.value},isEqualTo:function(t,i,e){var r=a.parseConditon("isEqualTo",t,i,e);return r.constraint==r.value},isNotEqualTo:function(t,i,e){var r=a.parseConditon("isNotEqualTo",t,i,e);return r.constraint!=r.value}},a.parseType={datepicker:function(a,t,e){var r=["yyyy-mm-dd","m/d/yyyy","mm/dd/yyyy","d/m/yyyy","dd/mm/yyyy","m-d-yyyy","mm-dd-yyyy","d-m-yyyy","dd-mm-yyyy"],n=0;t.length&&t.attr("data-datepicker_format")?n=t.attr("data-datepicker_format"):i.isString(r[t])?n=r[t]:t.parents("[data-datepicker_format]").length&&(n=t.parents("[data-datepicker_format]").eq(0).data("datepicker_format"));var s=r[n];return a=moment(a,s).format("X")}},a.constraints={isRequired:function(a){var t=null;return t=a.data("required")||t,t=a.data("validationRequired")||t,t=a.data("validationIsRequired")||t,t=a.is("[required]")||t,t=a.is("[data-required]")||t,t=a.is("[data-validation-required]")||t,t=a.is("[data-validation-is-required]")||t},isGreaterThan:function(a){var t=null;return a.is("[data-validation-is-greater-than]")&&(t=a.data("validationIsGreaterThan")),t},isGreaterOrEqualTo:function(a){var t=null;return a.is("[data-validation-is-greater-or-equal-to]")&&(t=a.data("validationIsGreaterOrEqualTo")),t},isLessThan:function(a){var t=null;return a.is("[data-validation-is-less-than]")&&(t=a.data("validationIsLessThan")),t},isLessOrEqualTo:function(a){var t=null;return a.is("[data-validation-is-less-or-equal-to]")&&(t=a.data("validationIsLessOrEqualTo")),t},isEqualTo:function(a){var t=null;return a.is("[data-validation-is-equal-to]")&&(t=a.data("validationIsEqualTo")),t},isNotEqualTo:function(a){var t=null;return a.is("[data-validation-is-not-equal-to]")&&(t=a.data("validationIsNotEqualTo")),t}},a.parseConditon=function(e,r,n,s){var o=s.data("validationType"),l=null,d={value:r,constraint:n};if(!i.isNumber(n)){if(l=t(n),!l.length)return console.warning("Tribe Validation:","Invalid selector for",s,selector),d;n=l.val()}return o&&i.isFunction(a.parseType[o])&&(d.constraint=a.parseType[o](n,l,s),d.value=a.parseType[o](r,l,s)),d},a.fn=function(){return this.each(a.setup)},a.setup=function(i,r){var n=t(r);n.addClass(a.selectors.item.className()),n.on("submit.tribe",a.onSubmit),n.on("validation.tribe",a.onValidation),n.on("displayErrors.tribe",a.onDisplayErrors),e.on("click.tribe",a.selectors.submit,a.onClickSubmitButtons),e.on("click.tribe",a.selectors.noticeDismiss,a.onClickDismissNotice)},a.validate=function(i,e){var r=t(e),n=a.isValid(r);n||(r.addClass(a.selectors.error.className()),r.one("change",a.onChangeFieldRemoveError))},a.isValid=function(t){var e=a.getConstraints(t);if(!i.isObject(e))return e;var r=i.every(e);return r},a.getConstraints=function(t){var e=!0,r=t.val(),n=t.is(":disabled"),s=a.constraints;return n?e:(s=i.mapObject(s,function(a){return a(t)}),s=i.pick(s,function(a){return null!==a}),i.isEmpty(s)?e:s=i.mapObject(s,function(i,e){return a.conditions[e](r,i,t)}))},a.onValidation=function(i){var e=t(this),r=e.find(a.selectors.fields);r.each(a.validate);var n=e.find(a.selectors.error);return 0!==n.length?void e.trigger("displayErrors.tribe"):void e.addClass(a.selectors.valid.className())},a.onDisplayErrors=function(r){var n=t(this),s=n.find(a.selectors.error),o=t("<ul>"),l=t("<span>").addClass(a.selectors.noticeDismiss.className()),d=e.find(a.selectors.notice),u=t("<div>").addClass("notice notice-error is-dismissible tribe-notice").addClass(a.selectors.notice.className()).append(l);if(s.each(function(e,r){var n=t(r),s=n.data("validationError");if(i.isObject(s)){var l={},d=a.getConstraints(n,!1);i.each(s,function(a,t){l[tribe.utils.camelCase(t)]=a}),i.each(d,function(t,i){t||a.addErrorLine(l[i],n,o)})}else a.addErrorLine(s,n,o)}),u.append(o),0===d.length){var c=e.find(a.selectors.noticeAfter);c.after(u)}else d.replaceWith(u)},a.addErrorLine=function(a,i,e){var r=t("<li>").text(a);r.data("validationField",i),i.data("validationNoticeItem",i),e.append(r)},a.onSubmit=function(i){var e=t(this);e.trigger("validation.tribe");var r=e.is(a.selectors.valid);if(!r)return i.preventDefault(),!1},a.onClickSubmitButtons=function(i){var e=t(this),r=e.parents(a.selectors.item);if(0!==r.length){r.trigger("validation.tribe");var n=r.find(a.selectors.fields);n.off("invalid.tribe"),n.one("invalid.tribe",a.onInvalidField)}},a.onInvalidField=function(i){var e=t(this),r=e.parents(a.selectors.item);return e.addClass(a.selectors.error.className()),r.trigger("displayErrors.tribe"),e.one("change",a.onChangeFieldRemoveError),i.preventDefault(),!1},a.onChangeFieldRemoveError=function(i){var e=t(this);e.hasClass(a.selectors.error.className())&&e.removeClass(a.selectors.error.className())},a.onClickDismissNotice=function(i){var e=t(this),r=e.parents(a.selectors.notice);r.remove()},a.onReady=function(i){t(a.selectors.item).validation()},t.fn.validation=a.fn,e.ready(a.onReady)}(tribe.validation,jQuery,_);